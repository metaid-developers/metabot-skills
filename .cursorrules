# MetaApp-Skill Cursor Rules

## 聊天监听脚本在 Cursor 内置终端运行

当用户请求**启动聊天监听**（如「让 XX 开启聊天监听」「开启统一聊天监听」「启动群聊监听」等）时，Cursor AI 执行对应脚本**必须**使用 `required_permissions: ["all"]`，否则会出现：

- **xhr poll error** - Socket.IO 连接 api.idchat.io 被沙箱阻断
- **fetch failed: getaddrinfo ENOTFOUND api.idchat.io** - 网络访问被阻断

### 适用脚本（默认优先统一聊天监听）

- `MetaBot-Chat/scripts/run_unified_chat_listener.sh` - 统一聊天监听（群聊 + 私聊，Socket 方式，**默认优先**）
- `MetaBot-Chat/scripts/run_group_chat_listener.sh` - 群聊监听（HTTP 轮询，**兜底方案**）

### 执行规范

当执行 run_unified_chat_listener.sh 时，run_terminal_cmd 必须传入：

```
required_permissions: ["all"]
```

以实现 Cursor 内一键启动、Socket 连接正常，方便用户无需切换到系统终端。

### 兜底说明

若沙箱仍出现 xhr poll error（如本 .cursorrules 未生效），AI 须提示用户「Socket 连接失败」，并给出兜底方案：在系统终端执行 run_unified_chat_listener.sh，或改用 run_group_chat_listener.sh（HTTP 轮询，仅群聊）。
